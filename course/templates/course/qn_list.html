<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>{% block title %}GaME{% endblock %}</title>
  <script>
	  function set_do_grade(qn_id){
		  document.getElementById("dg"+qn_id).value = "1"
	  }
	  function reset_do_grade(qn_id){
		  document.getElementById("dg"+qn_id).value = "0"
	  }
  </script>
</head>
<body>
  <main>
    {% block content %}
	Welcome, {{ user.username }}!
	<p>The weightage of this exam is {{ ex_wt }}.</p>
	{% if is_prof %}
		<p>Modify the weightage here</p>
		<form method="POST" action="{% url 'weightage_update_view' ex_id %}">
			{% csrf_token %}
			<input type="text" name="weightage" id="wtage">
			<button type="submit">Update weightage</button>
		</form>
		<p>Insert a new question here</p>
		<form method="POST" action="{% url 'add_qn_view' ex_id %}">
			{% csrf_token %}
			<input type="text" name="qn_id" id="qn_id_id" , placeholder="Question Number">
			<input type="text" name="tot_marks" id="tot_marks_id" , placeholder="Full Marks">
			<button type="submit">Create new question</button>
		</form>
	{% endif %}
	{% if question_list %}
		{% if role != 'student' %}
		<p>Click below to grade questions:</p>
		<ul>
			{% for qn in question_list %}
				<li><a href="/game/attempt_list/{{ qn.id }}"> Question number:{{ qn.qn_number }}; Full marks: {{ qn.full_marks }}</a>
				</li>
				{% if is_prof %}
					<form method="POST" action="{% url 'qn_adm_view' qn.id %}">
						{% csrf_token %}
						{% if num_graded > 0 %}
						<p>Some papers have been graded, you are advised not to distribute the papers amongst TAs</p>
						{% endif %}
						<input type="hidden" value="0" name="do_grade" id="dg{{qn.id}}">
						<button type="submit" onclick="set_do_grade('{{qn.id}}')">
							Distribute among all
						</button>
						<button type="submit" onclick="reset_do_grade('{{qn.id}}')">Distribute among TAs</button>
					</form>
				{% endif %}
			{% endfor %}
		</ul>
		{% endif %}
	{% endif %}
	{% if attempt_list %}
		<p>These are your attempts in this exam</p>
		<ul>
			{% for attempt in attempt_list %}

				{% if role == 'ta'%}
					<li><a href="/game/attempts_ta/{{ attempt.id }}">Question {{ attempt.question.qn_number }} ; Student: {{ attempt.student.id }}({{ attempt.student.username }}); Graded: {{ attempt.attempt_graded }}</a></li>
				{% elif role == 'student'%}
					<li><a href="/game/attempts_stud/{{ attempt.id }}">Question {{ attempt.question.qn_number }} ; Student: {{ attempt.student.id }}({{ attempt.student.username }}) ; Graded: {{ attempt.attempt_graded }}</a></li>
				{% else %}
					<li><a href="/game/attempts_ta/{{ attempt.id }}">Question {{ attempt.question.qn_number }} ; Student: {{ attempt.student.id }}({{ attempt.student.username }}) ; Graded: {{ attempt.attempt_graded }}</a></li>
				{% endif %}
				<!-- <li><a href="/game/{{ qn.course_id }}/exams">{{ course.course_id }}</a></li> -->
			
			{% endfor %}
		</ul>
	{% endif%}
	{% if not is_prof %}
		{% if not attempt_list %}
		    <p>Nothing interesting to show here.</p>
		{% endif %}
	{% endif %}
	{% endblock %}
	<a href="{% url 'logout' %}"> logout! </a>
  </main>
</body>
</html>
